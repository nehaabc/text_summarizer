<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Summarizer</title>

</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.4/dist/tesseract.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.js"></script>

<style>

body {
  font-family: Arial, sans-serif;
  background-image: url(./45f420_6e8d6c8c9fcd45d2bfa12ba24bbeb0a0~mv2.webp);
  background-color:rgb(199, 183, 183) ; 
  /* Change this to your desired color */
  text-align: center;
  margin: 20px;
  
}

* {
margin: 0;
padding: 0;
border: 0;
outline: 0;
font-size: 100%;
vertical-align: baseline;
box-sizing: border-box;
user-select: none;
}

button:active{
background: white;
color: black;
box-shadow:0 0 50px white;
border: 1px solid black;
}



body::-webkit-scrollbar {
  width: 8px; /* Adjust the width as needed */
}

body::-webkit-scrollbar-thumb {
  background-color: rgb(51, 30, 30); /* Change this to your desired color */
  border-radius: 10px;
}

body::-webkit-scrollbar-track {
  background-color: rgb(212, 199, 199);
  border-radius: 10px;
} 
button {
color: white;
height: 100%;
border-radius: 8px;
font-size: 20px;
background-color: rgb(61, 31, 31);
text-shadow: 0 1px 0 rgba(108, 12, 12, 0.1);
box-shadow: rgba(2, 4, 3, 0.2) 0px 2px 3px, rgba(2, 4, 3, 0.2) 0px 1.5px 2px,
rgba(255, 255, 255, 0.1) 0px 0px 0px 1px inset;
}

body{
  width: 95%;
}
.lol{
max-width: 500px;
margin: 5px;
padding: 15px;
}
input{
font-size: 100%;
}
.lol:hover{
background-color: rgb(165, 56, 56);
text-shadow: 0 0 7px rgb(253, 251, 251) ;
}

img{
  z-index: 30;
  width: 100px;
  height: 100px;
}
img:hover{
  transform: scale(3);
  transition: transform 2s;
}
.copy{
width:80px;
position: absolute;
height: 50px;
float: right;
}
.textarea{
  background-color: rgb(244, 219, 219);
    margin-top:50px;
    max-width:600px;
    height:300px;
    border:1px solid rgb(244, 219, 219);
    border-radius: 5px;
    box-shadow: 0px 4px 4px 4px rgb(141, 138, 138);
  }
  .get{
    height:30px;
    width:80%;
  }
  .textplace{
    overflow: auto;
    height: 200px;
    border: 1px solid rgb(244, 219, 219);
    width: 100%;
  }

</style>

<body>

<!-- //----------------------------------------------------------------------------------------------------------// -->
<h1 style="font-family:'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">Textminds</h1>
<h5 style="margin-bottom: 35px;">Intelligent text extraction and summarisation...</h5>
  <div style="z-index: 0;" id="cal" >
    <div class="calculator" style="margin-bottom: -10;">
      <button id="pdf" class="lol">
        Upload PDF
        <input type="file" accept=".pdf" id="pdfInput">
      </button>
      <button id="img" class="lol">
        Upload Image
        <input type="file" accept=".jpg" id="fileInput">
      </button>
    </div>
  </div>

<div class="container text-center">
  <div class="row" style="margin-top: 0px;">
    <div class="col">
      <div class="textarea">
        <button class="get" id="getPdf">Get Pdf text</button>
        <div style="width: 500px;" id="resultgetPdf" class="textplace"></div>
        <button onclick="copyText(1)" class="copy" id="pdf" style="height: 60px;">
          Copy Text
        </button>
      <div id="result"></div>
      </div>
    </div>
    <div class="col">
      <div class="textarea">
        <button class="get" id="GetIMg">Get img text</button>
        <div id="resultgetimg" style="width: 500px;" class="textplace"></div>
        <button onclick="copyText(2)" class="copy" id="img" style="height: 60px;">
          Copy Text
        </button>
        <button id="loading" style="display:none; height:50px;">Text Loading.....</button>
      </div>
       
    </div>
  </div>
  <div class="row" style="margin-top: 50px;">
    <div class="col">
  <div class="textarea">
    <form id="summarizeForm">
        <textarea id="text" name="text" rows="10" style="display:none;" cols="30"></textarea>
          <button type="button"  id="summarizePdf" class="get" style="width:350px;"  onclick="summarizeText()">Get Pdf text summry</button>
      </form>
      <div class="textplace" style="width: 500px;" id="summaryResult"></div>
      <button onclick="copyText(3)" class="copy" style="height: 60px;">
        Copy Text
      </button>
  </div>
    </div>
    <div class="col">
      <div class="textarea">
        <form id="summarizeForm">
            <textarea id="textimg" name="textimg" rows="10" style="display:none;" cols="30"></textarea>
              <button type="button" class="get" style="width:350px;"  id="summarizeImage"  onclick="summarizeTextImg()">Get img text sumary</button>
          </form>
          <div  class="textplace" id="summaryResultimg" style="width: 500px;"></div>
          <button onclick="copyText(4)" class="copy" style="height: 60px;">
            Copy Text
          </button>
        </div>
      </div>
      <div class="row" style="margin-top: 40px;">
        <button onclick="redirectToHistory()">Show History</button>
        <script>
          function redirectToHistory() {
      window.location.href = `${window.location.href}history`;
    }
        </script>
      </div>
  </div>
</div>

 <!-- /*****------------------------------------------------------------------------------------------------ -->

<script>
  document.getElementById('summarizeImage').addEventListener('click', function () {
    setTimeout(() => {
      summarizeImage();
    }, 2000);
  });

  document.getElementById('summarizePdf').addEventListener('click', function () {
    setTimeout(() => {
      summarizePdf();
    }, 2000);
  });
  
  

  function summarizeImage() {
  const textimg = document.getElementById('textimg').value;
  const summaryResultimg = document.getElementById('summaryResultimg').innerText;

  const fileInput = document.getElementById('fileInput');
  const file = fileInput.files[0];

  const formData = new FormData();
  formData.append('textimg', textimg);
  formData.append('summaryResultimg', summaryResultimg);
  formData.append('fileInput', file);

  fetch('http://localhost:3000/summarizeImage', {
    method: 'POST',
    body: formData,
  })
    .then(response => {
      if (!response.ok) {
        throw new Error(`Network response was not ok (${response.status} ${response.statusText})`);
      }
      return response.json();
    })
    .then(data => {
      console.log('Image data stored:', data.message);
      alert('Image data stored successfully');
    })
    .catch(error => {
      console.error('Fetch error:', error);
    });
}

function summarizePdf() {
  const text = document.getElementById('text').value;
  const summaryResult = document.getElementById('summaryResult').innerText;

  const formData = new FormData();
  formData.append('text', text);
  formData.append('summaryResult', summaryResult);

  fetch('http://localhost:3000/summarizePdf', {
    method: 'POST',
    body: formData,
  })
    .then(response => {
      if (!response.ok) {
        throw new Error(`Network response was not ok (${response.status} ${response.statusText})`);
      }
      return response.json();
    })
    .then(data => {
      console.log('PDF data stored:', data.message);
      alert('PDF data stored successfully');
    })
    .catch(error => {
      console.error('Fetch error:', error);
    });
}



  function summarizeText() {
      const text = document.getElementById('text').value;
     
        fetch('http://localhost:3000/summarize', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ text }),
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`Network response was not ok (${response.status} ${response.statusText})`);
            }
            return response.json();
        })
        .then(data => {
            console.log('Summary:', data.summary);
            document.getElementById('summaryResult').innerText = data.summary;
        })
        .catch(error => {
            console.error('Fetch error:', error);
        });
    }
  
    function summarizeTextImg() {
      const text = document.getElementById('textimg').value;
     
        fetch('http://localhost:3000/summarize', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ text }),
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`Network response was not ok (${response.status} ${response.statusText})`);
            }
            return response.json();
        })
        .then(data => {
            console.log('Summary:', data.summary);
            document.getElementById('summaryResultimg').innerText = data.summary;
        })
        .catch(error => {
            console.error('Fetch error:', error);
        });
    }


</script>
  <script>
    document.getElementById('fileInput').addEventListener('change', function (e) {
      console.log('working...');
      document.getElementById('loading').style.display = 'block';
      
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function (event) {
        const imgBase64 = event.target.result;
        document.getElementById('resultgetimg').innerHTML = '<img src="' + imgBase64 + '" alt="Image uploaded">';
        extractTextFromImage(imgBase64);
      };
      reader.readAsDataURL(file);
    });
    
    async function extractTextFromImage(imgBase64) {
      const result = await Tesseract.recognize(
        imgBase64,
        'eng',
        { logger: m => console.log(m) }
        );
        
        const resultDiv = document.getElementById('resultgetimg');
        document.getElementById('loading').style.display = 'none';
        
        
        resultDiv.innerHTML +=result.data.text 
        document.getElementById('textimg').innerHTML =result.data.text

        console.log('working...');
        console.log(result.data.text);
    }
</script>
<script>

   document.getElementById('getPdf').addEventListener('click', function () {
    console.log('working...');

  var fileInput = document.getElementById('pdfInput');

  var file = fileInput.files[0];
    if (file) {
      var reader = new FileReader();
      reader.onload = function (e) {
        var arrayBuffer = e.target.result;

        // Using PDF.js to extract text from PDF
        pdfjsLib.getDocument({ data: arrayBuffer }).promise.then(function (pdfDoc) {
          var numPages = pdfDoc.numPages;
          var text = '';

          function extractText(pageNum) {
            return pdfDoc.getPage(pageNum).then(function (page) {
              return page.getTextContent().then(function (textContent) {
                return textContent.items.map(function (s) { return s.str; }).join(' ');
              });
            });
          }

          // Extract text from all pages
          var promises = [];
          for (var i = 1; i <= numPages; i++) {
            promises.push(extractText(i));
          }

          Promise.all(promises).then(function (results) {
            text = results.join(' ');
            document.getElementById('resultgetPdf').innerHTML = text;
            document.getElementById('text').innerHTML = text;
           
          });
        });
      };
      reader.readAsArrayBuffer(file);
    } 
   
  });
 

  function copyText(x) {
    var textToCopy;
    if(x==1){
      textToCopy = document.getElementById('resultgetPdf').innerText;
    }
    else if(x==2){
      textToCopy = document.getElementById('resultgetimg').innerText;
    }
    else if(x==3){
      textToCopy = document.getElementById('summaryResult').innerText;
    }
    else if(x==4){
      textToCopy = document.getElementById('summaryResultimg').innerText;
    }
   
// Create a temporary textarea element to copy the text
var tempTextArea = document.createElement('textarea');
tempTextArea.value = textToCopy;
document.body.appendChild(tempTextArea);

// Select and copy the text
tempTextArea.select();
document.execCommand('copy');

// Remove the temporary textarea
document.body.removeChild(tempTextArea);
alert('Textarea copied successfully')

}

</script>

 <!-- /*****------------------------------------------------------------------------------------------------ -->

</body>


</html>
